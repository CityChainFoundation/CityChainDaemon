<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Interface IStakeValidator
   | City Chain: Developer Reference </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Interface IStakeValidator
   | City Chain: Developer Reference ">
    <meta name="generator" content="docfx 2.40.1.0">
    
    <link rel="shortcut icon" href="../images/favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/icon.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator">
  
  
  <h1 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator" class="text-break">Interface IStakeValidator
  </h1>
  <div class="markdown level0 summary"><p>Provides functionality for checking validity of PoS blocks.
See <see cref="!:Stratis.Bitcoin.Features.Miner.PosMinting"></see> for more information about PoS solutions.</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <h6><strong>Namespace</strong>: <a class="xref" href="Stratis.Bitcoin.Features.Consensus.Interfaces.html">Stratis.Bitcoin.Features.Consensus.Interfaces</a></h6>
  <h6><strong>Assembly</strong>: Stratis.Bitcoin.Features.Consensus.dll</h6>
  <h5 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public interface IStakeValidator</code></pre>
  </div>
  <h3 id="methods">Methods
  </h3>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CalculateRetarget_System_UInt32_NBitcoin_Target_System_UInt32_NBitcoin_BouncyCastle_Math_BigInteger_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CalculateRetarget(System.UInt32%2CNBitcoin.Target%2CSystem.UInt32%2CNBitcoin.BouncyCastle.Math.BigInteger)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L124">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CalculateRetarget_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CalculateRetarget*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CalculateRetarget_System_UInt32_NBitcoin_Target_System_UInt32_NBitcoin_BouncyCastle_Math_BigInteger_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CalculateRetarget(System.UInt32,NBitcoin.Target,System.UInt32,NBitcoin.BouncyCastle.Math.BigInteger)">CalculateRetarget(UInt32, Target, UInt32, BigInteger)</h4>
  <div class="markdown level1 summary"><p>Calculates the difficulty between two block time spans.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">Target CalculateRetarget(uint firstBlockTime, Target firstBlockTarget, uint secondBlockTime, BigInteger targetLimit)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.UInt32</span></td>
        <td><span class="parametername">firstBlockTime</span></td>
        <td><p>The time of the first block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.Target.html">Target</a></td>
        <td><span class="parametername">firstBlockTarget</span></td>
        <td><p>The target of the first block.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.UInt32</span></td>
        <td><span class="parametername">secondBlockTime</span></td>
        <td><p>The block time of the second block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.BouncyCastle.Math.BigInteger.html">BigInteger</a></td>
        <td><span class="parametername">targetLimit</span></td>
        <td><p>The upper limit of what the target can be.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="NBitcoin.Target.html">Target</a></td>
        <td><p>The new difficulty target as the outcome of the previous two blocks.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CalculateRetarget_System_UInt32_NBitcoin_Target_System_UInt32_NBitcoin_BouncyCastle_Math_BigInteger__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>The calculation of the next target is based on the last target value and the block time (aka spacing) of <code data-dev-comment-type="paramref" class="paramref">firstBlockTime</code>
(i.e. difference in time stamp of this block and its immediate predecessor). The target changes every block and it is adjusted
down (i.e. towards harder to reach, or more difficult) if the time to mine last block was lower than the target block time.
And it is adjusted up if it took longer than the target block time. The adjustments are done in a way the target is moving towards
the target-spacing (expected block time) exponentially, so even a big change in the mining power on the network will be fixed by retargeting relatively quickly.</p>
<p>
Over <see cref="!:RetargetIntervalMinutes"></see> minutes there are certain number (say <code>N</code>) of blocks expected to be mined if the target block time
of <see cref="!:TargetSpacingSeconds"></see> was reached every time. Then the next target is calculated as follows:</p>
<pre><code>NewTarget = PrevTarget * ((N - 1) * TargetSpacingSeconds + 2 * LastBlockTime) / ((N + 1) * TargetSpacingSeconds)</code></pre>
<p>
Which basically says that the block time of the last block is counted twice instead of two optimal block times.
And the <code>N</code> determines how strongly will the deviation of the last block time affect the difficulty.
</p>
</div>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckKernel_Stratis_Bitcoin_Features_Consensus_PosRuleContext_NBitcoin_ChainedHeader_System_UInt32_System_Int64_NBitcoin_OutPoint_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckKernel(Stratis.Bitcoin.Features.Consensus.PosRuleContext%2CNBitcoin.ChainedHeader%2CSystem.UInt32%2CSystem.Int64%2CNBitcoin.OutPoint)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L24">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckKernel_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckKernel*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckKernel_Stratis_Bitcoin_Features_Consensus_PosRuleContext_NBitcoin_ChainedHeader_System_UInt32_System_Int64_NBitcoin_OutPoint_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckKernel(Stratis.Bitcoin.Features.Consensus.PosRuleContext,NBitcoin.ChainedHeader,System.UInt32,System.Int64,NBitcoin.OutPoint)">CheckKernel(PosRuleContext, ChainedHeader, UInt32, Int64, OutPoint)</h4>
  <div class="markdown level1 summary"><p>Checks that UTXO is valid for staking and then checks kernel hash.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">bool CheckKernel(PosRuleContext context, ChainedHeader prevChainedHeader, uint headerBits, long transactionTime, OutPoint prevout)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Features.Consensus.PosRuleContext.html">PosRuleContext</a></td>
        <td><span class="parametername">context</span></td>
        <td><p>Staking context.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><span class="parametername">prevChainedHeader</span></td>
        <td><p>Previous chained block.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.UInt32</span></td>
        <td><span class="parametername">headerBits</span></td>
        <td><p>Chained block's header bits, which define the difficulty target.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.Int64</span></td>
        <td><span class="parametername">transactionTime</span></td>
        <td><p>Transaction time.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.OutPoint.html">OutPoint</a></td>
        <td><span class="parametername">prevout</span></td>
        <td><p>Information about transaction id and index.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p>Returns true if a correct hash was discovered.</p>
</td>
      </tr>
    </tbody>
  </table>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckProofOfStake_Stratis_Bitcoin_Features_Consensus_PosRuleContext_NBitcoin_ChainedHeader_NBitcoin_BlockStake_NBitcoin_Transaction_System_UInt32_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckProofOfStake(Stratis.Bitcoin.Features.Consensus.PosRuleContext%2CNBitcoin.ChainedHeader%2CNBitcoin.BlockStake%2CNBitcoin.Transaction%2CSystem.UInt32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L67">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckProofOfStake_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckProofOfStake*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckProofOfStake_Stratis_Bitcoin_Features_Consensus_PosRuleContext_NBitcoin_ChainedHeader_NBitcoin_BlockStake_NBitcoin_Transaction_System_UInt32_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckProofOfStake(Stratis.Bitcoin.Features.Consensus.PosRuleContext,NBitcoin.ChainedHeader,NBitcoin.BlockStake,NBitcoin.Transaction,System.UInt32)">CheckProofOfStake(PosRuleContext, ChainedHeader, BlockStake, Transaction, UInt32)</h4>
  <div class="markdown level1 summary"><p>Checks if provided transaction is a valid coinstake transaction.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">void CheckProofOfStake(PosRuleContext context, ChainedHeader prevChainedHeader, BlockStake prevBlockStake, Transaction transaction, uint headerBits)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Features.Consensus.PosRuleContext.html">PosRuleContext</a></td>
        <td><span class="parametername">context</span></td>
        <td><p>Staking context.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><span class="parametername">prevChainedHeader</span></td>
        <td><p>Previous chained block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.BlockStake.html">BlockStake</a></td>
        <td><span class="parametername">prevBlockStake</span></td>
        <td><p>Information about previous staked block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.Transaction.html">Transaction</a></td>
        <td><span class="parametername">transaction</span></td>
        <td><p>The transaction.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.UInt32</span></td>
        <td><span class="parametername">headerBits</span></td>
        <td><p>Chained block's header bits, which define the difficulty target.</p>
</td>
      </tr>
    </tbody>
  </table>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckStakeKernelHash_Stratis_Bitcoin_Features_Consensus_PosRuleContext_System_UInt32_NBitcoin_BlockStake_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_OutPoint_System_UInt32_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckStakeKernelHash(Stratis.Bitcoin.Features.Consensus.PosRuleContext%2CSystem.UInt32%2CNBitcoin.BlockStake%2CStratis.Bitcoin.Utilities.UnspentOutputs%2CNBitcoin.OutPoint%2CSystem.UInt32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L56">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckStakeKernelHash_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckStakeKernelHash*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckStakeKernelHash_Stratis_Bitcoin_Features_Consensus_PosRuleContext_System_UInt32_NBitcoin_BlockStake_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_OutPoint_System_UInt32_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.CheckStakeKernelHash(Stratis.Bitcoin.Features.Consensus.PosRuleContext,System.UInt32,NBitcoin.BlockStake,Stratis.Bitcoin.Utilities.UnspentOutputs,NBitcoin.OutPoint,System.UInt32)">CheckStakeKernelHash(PosRuleContext, UInt32, BlockStake, UnspentOutputs, OutPoint, UInt32)</h4>
  <div class="markdown level1 summary"><p>Checks that the stake kernel hash satisfies the target difficulty.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">bool CheckStakeKernelHash(PosRuleContext context, uint headerBits, BlockStake prevBlockStake, UnspentOutputs stakingCoins, OutPoint prevout, uint transactionTime)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Features.Consensus.PosRuleContext.html">PosRuleContext</a></td>
        <td><span class="parametername">context</span></td>
        <td><p>Staking context.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.UInt32</span></td>
        <td><span class="parametername">headerBits</span></td>
        <td><p>Chained block's header bits, which define the difficulty target.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.BlockStake.html">BlockStake</a></td>
        <td><span class="parametername">prevBlockStake</span></td>
        <td><p>Information about previous staked block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Utilities.UnspentOutputs.html">UnspentOutputs</a></td>
        <td><span class="parametername">stakingCoins</span></td>
        <td><p>Coins that participate in staking.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.OutPoint.html">OutPoint</a></td>
        <td><span class="parametername">prevout</span></td>
        <td><p>Information about transaction id and index.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.UInt32</span></td>
        <td><span class="parametername">transactionTime</span></td>
        <td><p>Transaction time.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p>Returns true if a correct hash was discovered.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_CheckStakeKernelHash_Stratis_Bitcoin_Features_Consensus_PosRuleContext_System_UInt32_NBitcoin_BlockStake_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_OutPoint_System_UInt32__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>Coinstake must meet hash target according to the protocol:
kernel (input 0) must meet the formula
<code>hash(stakeModifierV2 + stakingCoins.Time + prevout.Hash + prevout.N + transactionTime) &lt; target * weight</code>.
This ensures that the chance of getting a coinstake is proportional to the amount of coins one owns.</p>
<p>
The reason this hash is chosen is the following:
<ol><li></li><li></li><li></li><li></li><li></li></ol>
Block or transaction tx hash should not be used here as they can be generated in vast
quantities so as to generate blocks faster, degrading the system back into a proof-of-work situation.
</p>
</div>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_ComputeStakeModifierV2_NBitcoin_ChainedHeader_NBitcoin_BlockStake_NBitcoin_uint256_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.ComputeStakeModifierV2(NBitcoin.ChainedHeader%2CNBitcoin.BlockStake%2CNBitcoin.uint256)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L76">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_ComputeStakeModifierV2_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.ComputeStakeModifierV2*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_ComputeStakeModifierV2_NBitcoin_ChainedHeader_NBitcoin_BlockStake_NBitcoin_uint256_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.ComputeStakeModifierV2(NBitcoin.ChainedHeader,NBitcoin.BlockStake,NBitcoin.uint256)">ComputeStakeModifierV2(ChainedHeader, BlockStake, uint256)</h4>
  <div class="markdown level1 summary"><p>Computes stake modifier.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">uint256 ComputeStakeModifierV2(ChainedHeader prevChainedHeader, BlockStake blockStakePrev, uint256 kernel)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><span class="parametername">prevChainedHeader</span></td>
        <td><p>Previous chained block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.BlockStake.html">BlockStake</a></td>
        <td><span class="parametername">blockStakePrev</span></td>
        <td><p>Previous PoS block.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.uint256.html">uint256</a></td>
        <td><span class="parametername">kernel</span></td>
        <td><p>The PoS kernel.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="NBitcoin.uint256.html">uint256</a></td>
        <td><p>Stake modifier.</p>
</td>
      </tr>
    </tbody>
  </table>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_GetLastPowPosChainedBlock_Stratis_Bitcoin_Features_Consensus_IStakeChain_NBitcoin_ChainedHeader_System_Boolean_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.GetLastPowPosChainedBlock(Stratis.Bitcoin.Features.Consensus.IStakeChain%2CNBitcoin.ChainedHeader%2CSystem.Boolean)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L87">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_GetLastPowPosChainedBlock_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.GetLastPowPosChainedBlock*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_GetLastPowPosChainedBlock_Stratis_Bitcoin_Features_Consensus_IStakeChain_NBitcoin_ChainedHeader_System_Boolean_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.GetLastPowPosChainedBlock(Stratis.Bitcoin.Features.Consensus.IStakeChain,NBitcoin.ChainedHeader,System.Boolean)">GetLastPowPosChainedBlock(IStakeChain, ChainedHeader, Boolean)</h4>
  <div class="markdown level1 summary"><p>Gets the last block in the chain that was generated using
PoS if <code data-dev-comment-type="paramref" class="paramref">proofOfStake</code> is <code>true</code> or PoW if <code data-dev-comment-type="paramref" class="paramref">proofOfStake</code> is <code>false</code>.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">ChainedHeader GetLastPowPosChainedBlock(IStakeChain stakeChain, ChainedHeader startChainedHeader, bool proofOfStake)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Features.Consensus.IStakeChain.html">IStakeChain</a></td>
        <td><span class="parametername">stakeChain</span></td>
        <td><p>Database of stake related data for the current blockchain.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><span class="parametername">startChainedHeader</span></td>
        <td><p>Block that we start from. Only blocks before that one will be checked.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><span class="parametername">proofOfStake</span></td>
        <td><p>Specifies what kind of block we are looking for: <code>true</code> for PoS or <code>false</code> for PoW.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><p>Last block in the chain that satisfies provided requirements.</p>
</td>
      </tr>
    </tbody>
  </table>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_GetNextTargetRequired_Stratis_Bitcoin_Features_Consensus_IStakeChain_NBitcoin_ChainedHeader_NBitcoin_IConsensus_System_Boolean_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.GetNextTargetRequired(Stratis.Bitcoin.Features.Consensus.IStakeChain%2CNBitcoin.ChainedHeader%2CNBitcoin.IConsensus%2CSystem.Boolean)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L97">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_GetNextTargetRequired_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.GetNextTargetRequired*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_GetNextTargetRequired_Stratis_Bitcoin_Features_Consensus_IStakeChain_NBitcoin_ChainedHeader_NBitcoin_IConsensus_System_Boolean_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.GetNextTargetRequired(Stratis.Bitcoin.Features.Consensus.IStakeChain,NBitcoin.ChainedHeader,NBitcoin.IConsensus,System.Boolean)">GetNextTargetRequired(IStakeChain, ChainedHeader, IConsensus, Boolean)</h4>
  <div class="markdown level1 summary"><p>Calculates the difficulty target for the next block.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">Target GetNextTargetRequired(IStakeChain stakeChain, ChainedHeader chainedHeader, IConsensus consensus, bool proofOfStake)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Features.Consensus.IStakeChain.html">IStakeChain</a></td>
        <td><span class="parametername">stakeChain</span></td>
        <td><p>Database of stake related data for the current blockchain.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><span class="parametername">chainedHeader</span></td>
        <td><p>Block header for which to calculate the target difficulty.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.IConsensus.html">IConsensus</a></td>
        <td><span class="parametername">consensus</span></td>
        <td><p>Consensus rules for the current network.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><span class="parametername">proofOfStake</span></td>
        <td><p><code>true</code> for calculation of PoS difficulty target, <code>false</code> for calculation of PoW difficulty target.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="NBitcoin.Target.html">Target</a></td>
        <td><p>The difficulty target for the next block after <code data-dev-comment-type="paramref" class="paramref">chainedHeader</code>.</p>
</td>
      </tr>
    </tbody>
  </table>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_IsConfirmedInNPrevBlocks_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_ChainedHeader_System_Int64_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.IsConfirmedInNPrevBlocks(Stratis.Bitcoin.Utilities.UnspentOutputs%2CNBitcoin.ChainedHeader%2CSystem.Int64)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L143">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_IsConfirmedInNPrevBlocks_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.IsConfirmedInNPrevBlocks*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_IsConfirmedInNPrevBlocks_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_ChainedHeader_System_Int64_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.IsConfirmedInNPrevBlocks(Stratis.Bitcoin.Utilities.UnspentOutputs,NBitcoin.ChainedHeader,System.Int64)">IsConfirmedInNPrevBlocks(UnspentOutputs, ChainedHeader, Int64)</h4>
  <div class="markdown level1 summary"><p>Returns <code>true</code> if provided coins were confirmed in less than <code data-dev-comment-type="paramref" class="paramref">targetDepth</code> number of blocks.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">bool IsConfirmedInNPrevBlocks(UnspentOutputs coins, ChainedHeader referenceChainedHeader, long targetDepth)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Utilities.UnspentOutputs.html">UnspentOutputs</a></td>
        <td><span class="parametername">coins</span></td>
        <td><p>Coins to check confirmation depth for.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.ChainedHeader.html">ChainedHeader</a></td>
        <td><span class="parametername">referenceChainedHeader</span></td>
        <td><p>Chained block from which we are counting the depth.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.Int64</span></td>
        <td><span class="parametername">targetDepth</span></td>
        <td><p>The target depth.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p><code>true</code> if the coins were spent within N blocks from <see cref="!:referenceChainedHeader"></see>, <code>false</code> otherwise.</p>
</td>
      </tr>
    </tbody>
  </table>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_VerifySignature_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_Transaction_System_Int32_NBitcoin_ScriptVerify_.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.VerifySignature(Stratis.Bitcoin.Utilities.UnspentOutputs%2CNBitcoin.Transaction%2CSystem.Int32%2CNBitcoin.ScriptVerify)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L134">View Source</a>
  </span>
  <a id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_VerifySignature_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.VerifySignature*"></a>
  <h4 id="Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator_VerifySignature_Stratis_Bitcoin_Utilities_UnspentOutputs_NBitcoin_Transaction_System_Int32_NBitcoin_ScriptVerify_" data-uid="Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator.VerifySignature(Stratis.Bitcoin.Utilities.UnspentOutputs,NBitcoin.Transaction,System.Int32,NBitcoin.ScriptVerify)">VerifySignature(UnspentOutputs, Transaction, Int32, ScriptVerify)</h4>
  <div class="markdown level1 summary"><p>Verifies transaction's signature.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">bool VerifySignature(UnspentOutputs coin, Transaction txTo, int txToInN, ScriptVerify flagScriptVerify)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="Stratis.Bitcoin.Utilities.UnspentOutputs.html">UnspentOutputs</a></td>
        <td><span class="parametername">coin</span></td>
        <td><p>UTXO that is spent in the transaction.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.Transaction.html">Transaction</a></td>
        <td><span class="parametername">txTo</span></td>
        <td><p>Transaction.</p>
</td>
      </tr>
      <tr>
        <td><span class="xref">System.Int32</span></td>
        <td><span class="parametername">txToInN</span></td>
        <td><p>Index of the transaction's input.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="NBitcoin.ScriptVerify.html">ScriptVerify</a></td>
        <td><span class="parametername">flagScriptVerify</span></td>
        <td><p>Script verification flags.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><span class="xref">System.Boolean</span></td>
        <td><p><code>true</code> if signature is valid.</p>
</td>
      </tr>
    </tbody>
  </table>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/CityChainFoundation/city-chain/new/master/docs-ref-overwrite/new?filename=Stratis_Bitcoin_Features_Consensus_Interfaces_IStakeValidator.md&amp;value=---%0Auid%3A%20Stratis.Bitcoin.Features.Consensus.Interfaces.IStakeValidator%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="contribution-link">Improve this Doc</a>
                  </li>
                  <li>
                    <a href="https://github.com/CityChainFoundation/city-chain/blob/master/src/Stratis.Bitcoin.Features.Consensus/Interfaces/IStakeValidator.cs/#L13" class="contribution-link">View Source</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <a href='https://city-chain.org'>city-chain.org</a> | <a href='https://citychain.foundation'>citychain.foundation</a>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
